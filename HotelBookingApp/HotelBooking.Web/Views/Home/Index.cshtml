@using HotelBooking.Services.ViewModels;
@model ApiDataViewModel

@{
    ViewData["Title"] = "EasyBook";
}

<h4 style="color: lightgray">Popular Destinations</h4>
<span class="h4-underline"></span>

<div id="carouselDiv">
<div id="carouselExampleCaptions" class="carousel slide">
    
    <div class="carousel-indicators">
        <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="0" class="active" aria-current="true" aria-label="Slide 1"></button>
        <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="1" aria-label="Slide 2"></button>
        <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="2" aria-label="Slide 3"></button>
        <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="3" aria-label="Slide 4"></button>
        <button type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide-to="4" aria-label="Slide 5"></button>
    </div>
    <div class="carousel-inner">
        <div class="carousel-item active">
            <img src="~/img/newParis.jpg" class="d-block w-100" alt="...">
            <div class="carousel-caption d-none d-md-block">
                <h5>Paris</h5>
            </div>
        </div>
        <div class="carousel-item">
            <img src="~/img/Rome.jpg" class="d-block w-100" alt="...">
            <div class="carousel-caption d-none d-md-block">
                <h5>Rome</h5>
            </div>
        </div>
        <div class="carousel-item">
            <img src="~/img/london.jpg" class="d-block w-100" alt="...">
            <div class="carousel-caption d-none d-md-block">
                <h5>London</h5>
            </div>
        </div>
        <div class="carousel-item">
            <img src="~/img/NewYork.jpg" class="d-block w-100" alt="...">
            <div class="carousel-caption d-none d-md-block">
                <h5>NewYork</h5>
            </div>
        </div>
        <div class="carousel-item">
            <img src="~/img/Dubai.jpg" class="d-block w-100" alt="...">
            <div class="carousel-caption d-none d-md-block">
                <h5>Dubai</h5>
            </div>
        </div>
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="prev">
        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Previous</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleCaptions" data-bs-slide="next">
        <span class="carousel-control-next-icon" aria-hidden="true"></span>
        <span class="visually-hidden">Next</span>
    </button>
</div>
</div>




<div class="container mt-5">
    <h1>Find your next stay</h1>
    <h4>Search low prices on hotels, homes and much more...</h4>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr/dist/flatpickr.min.css">
    <style>
      /* Make all text inputs, date inputs, and selects the same height */
      .equal-h { height: 42px; }
      .city-suggestions {
        position: absolute;
        left: 0;           /* anchor to the start (left) of the input */
        top: calc(100% + 4px); /* just below the input */
        z-index: 1050;
        display: none;
        max-height: 240px;
        overflow-y: auto;
        width: 100%;
        background: #fff;
        border: 1px solid rgba(0,0,0,.125);
        border-radius: .375rem;
        box-shadow: 0 .5rem 1rem rgba(0,0,0,.15);
      }
      .city-suggestions .suggestion-item { cursor: pointer; }
      .city-suggestions .suggestion-item:hover { background-color: #f8f9fa; }
    </style>
    <form id="reservationForm" asp-action="HotelsSearch" asp-controller="Hotels" method="post">


        <div class="form-group">
            <label for="price-range">Price Range:</label>
            <input type="range" class="form-range" id="price-range" min="0" max="2000" step="50" value="50"
                   oninput="updatePriceRange(this.value);" asp-for="MaxPrice">
            <div class="d-flex justify-content-between align-items-center">
                <span>$0</span>
                <span>$2000</span>
            </div>
            <div class="d-flex justify-content-center">
                <span id="price-range-value" >$0</span>
            </div>
        </div>


        
        <div class="form-container grid-container d-flex align-items-end flex-nowrap gap-1" >
            <div class="col-3 position-relative" style="width:auto;">
                <input type="text" class="form-control equal-h" id="city" name="City" asp-for="@Model.City" placeholder="City" required autocomplete="off" aria-haspopup="listbox" aria-expanded="false">
                <div id="citySuggestions" class="city-suggestions" role="listbox" aria-label="City suggestions"></div>
            </div>
            <div class="col-3" style="width:auto;">
                <input type="text" class="form-control equal-h js-date" id="checkinDate" name="CheckinDate" asp-for="@Model.CheckinDate" placeholder="Check-in Date" required autocomplete="off" inputmode="none">
            </div>
            <div class="col-3" style="width:auto;">
                <input type="text" class="form-control equal-h js-date" id="checkoutDate" name="CheckoutDate" asp-for="@Model.CheckoutDate" placeholder="Check-out Date" required autocomplete="off" inputmode="none">
            </div>
            <div class="col-3" style="width:auto;">
                <select id="locale" class="form-select equal-h" asp-for="@Model.Locale" required>
                    <option value="" disabled selected hidden>Language</option>
                    <option value="en-us">English</option>
                    <option value="de">German</option>
                    <option value="es">Spanish</option>
                    <option value="fr">French</option>
                    <option value="bg">Bulgarian</option>
                    <option value="it">Italian</option>
                </select>
            </div>
            <div class="col-3" style="width:auto;">
                <button type="submit" class="btn btn-primary">Search</button>
                </div>
        </div>
    </form>
    <script src="https://cdn.jsdelivr.net/npm/flatpickr"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        flatpickr('#checkinDate', { dateFormat: 'Y-m-d', allowInput: true });
        flatpickr('#checkoutDate', { dateFormat: 'Y-m-d', allowInput: true });

        const cityInput = document.getElementById('city');
        const citySuggestions = document.getElementById('citySuggestions');
        const popularCities = ['Sofia','Plovdiv','Sozopol','Varna'];

        function renderCitySuggestions(filterText) {
          const q = (filterText || '').trim().toLowerCase();
          const results = q ? popularCities.filter(c => c.toLowerCase().startsWith(q)) : popularCities;
          if (results.length === 0) {
            citySuggestions.innerHTML = '<div class="px-3 py-2 text-muted">No matches</div>';
          } else {
            citySuggestions.innerHTML = results.map(c => `<div class="suggestion-item px-3 py-2" role="option" data-value="${c}">${c}</div>`).join('');
          }
        }

        function openCitySuggestions() {
          renderCitySuggestions(cityInput.value);
          citySuggestions.style.display = 'block';
          cityInput.setAttribute('aria-expanded', 'true');
        }
        function closeCitySuggestions() {
          citySuggestions.style.display = 'none';
          cityInput.setAttribute('aria-expanded', 'false');
        }

        cityInput.addEventListener('focus', openCitySuggestions);
        cityInput.addEventListener('click', openCitySuggestions);
        cityInput.addEventListener('input', () => {
          renderCitySuggestions(cityInput.value);
          citySuggestions.style.display = 'block';
        });
        // Use mousedown so selection registers before the input loses focus
        citySuggestions.addEventListener('mousedown', (e) => {
          const item = e.target.closest('.suggestion-item');
          if (item) {
            cityInput.value = item.getAttribute('data-value');
            closeCitySuggestions();
          }
        });
        cityInput.addEventListener('blur', () => setTimeout(closeCitySuggestions, 100));
      });
    </script>
</div>
<br />
<br />


